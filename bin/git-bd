#!/bin/bash

set -e

git_branch_delete() {
  if test -z "$1"; then
    echo "Usage: git bd [.|:] <branch>" >&2
    exit 1
  elif test "$1" = ':'; then
    selected_branch_ref=$(git branch --format='%(refname)' | fzf --reverse)
    selected_branch=${selected_branch_ref#*/*/}
  elif test "$1" = '.'; then
    selected_branch="$(git branch --show-current)"
  else
    selected_branch="$1"
  fi

  (
    set -x
    git branch -D "$selected_branch"
  )
}

git_branch_delete "$@"
