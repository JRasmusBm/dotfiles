#!/bin/sh

set -e

_line="$1"
if test "$_line" = '0' ; then
 _line='10'
fi

file_name=$HOME/.tmux-speeddial
session_name=$(head -"$_line" <"$file_name" | tail -1)

if ! (tmux list-sessions | grep -q "$session_name") ; then
  root_folder="$(echo "$session_name" | xargs zoxide query)"
  cd "$root_folder" || return 1
  INITIATED_EXTERNALLY=false source_tmux_script "$root_folder/.tmux" || default_tmux_session
  return 0
fi

tmux-attach-to-session "$session_name:vim" || ta "$session_name" || true
