#!/bin/bash

in="$1"
IFS=':'; arr_in=($in); unset IFS;
path=${arr_in[0]}
line=${arr_in[1]}

contents=$(bat --color=always $path)

if [ -z $line ]; then
  echo "$contents"
  exit 0
fi

let first_line=0
let total_lines=$(< $path wc -l)

let show_on_line=10
let line_range_start=$(($line-$show_on_line < $first_line ? $first_line : $line - $show_on_line))
let line_range_end=$(($line+$show_on_line > $total_lines ? $total_lines : $line+$show_on_line ))

contents=$(echo -e "$contents" | tail -n +$line_range_start | head -n +$line_range_end)
echo "$contents"

